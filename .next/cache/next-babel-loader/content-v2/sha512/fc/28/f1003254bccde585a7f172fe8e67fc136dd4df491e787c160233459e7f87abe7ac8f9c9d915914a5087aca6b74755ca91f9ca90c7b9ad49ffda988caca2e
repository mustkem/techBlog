{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _classCallCheck from \"/home/mustkeem/Documents/My Projects/all-projects/codemedium/codemedium-frontend/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/mustkeem/Documents/My Projects/all-projects/codemedium/codemedium-frontend/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"/home/mustkeem/Documents/My Projects/all-projects/codemedium/codemedium-frontend/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"/home/mustkeem/Documents/My Projects/all-projects/codemedium/codemedium-frontend/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"/home/mustkeem/Documents/My Projects/all-projects/codemedium/codemedium-frontend/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/mustkeem/Documents/My Projects/all-projects/codemedium/codemedium-frontend/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"/home/mustkeem/Documents/My Projects/all-projects/codemedium/codemedium-frontend/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from \"react\";\nimport { Editor } from \"@tinymce/tinymce-react\";\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from \"reactstrap\";\nimport { connect } from \"react-redux\";\nimport axios from \"axios\";\nimport { API_URL } from \"../../../config\";\nimport Select from \"react-select\";\nimport Preview from \"./Preview\";\n\nvar CreatePost = /*#__PURE__*/function (_React$Component) {\n  _inherits(CreatePost, _React$Component);\n\n  var _super = _createSuper(CreatePost);\n\n  function CreatePost(props) {\n    var _this;\n\n    _classCallCheck(this, CreatePost);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"getCategories\", function () {\n      axios({\n        method: \"get\",\n        url: API_URL + \"/admin/common/categories\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: \"Bearer \" + localStorage.getItem(\"codemedium-token-admin\")\n        }\n      }).then(function (response) {\n        _this.setState({\n          categories: response.data.categories.map(function (item) {\n            return _objectSpread(_objectSpread({}, item), {}, {\n              value: item._id\n            });\n          })\n        });\n\n        return response.data;\n      })[\"catch\"](function (error) {\n        return error;\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleChange\", function (e, key) {\n      _this.setState(_defineProperty({}, key, e.target.value));\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleEditorChange\", function (content, editor) {\n      console.log(\"Content was updated:\", content);\n\n      _this.setState({\n        content: content\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"addPost\", function (e) {\n      console.log(\"content\", _this.state.content);\n      e.preventDefault();\n\n      var slug = _this.state.title.replace(/\\s/g, \"-\");\n\n      if (_this.props.slug) {\n        slug = _this.props.slug;\n      }\n\n      var formData = new FormData();\n      formData.append(\"title\", _this.state.title);\n      formData.append(\"image\", _this.state.image);\n      formData.append(\"content\", _this.state.content);\n      formData.append(\"desc\", _this.state.desc);\n      formData.append(\"creator\", _this.props.user.userId);\n      formData.append(\"slug\", slug);\n      formData.append(\"authorCode\", _this.state.authorCode);\n      formData.append(\"categories\", JSON.stringify(_this.state.selectedCategories.map(function (item) {\n        return item.value;\n      })));\n      console.log(formData);\n      axios({\n        method: \"post\",\n        url: API_URL + \"/admin/feed/post\",\n        headers: {\n          \"Content-Type\": \"multipart/form-data\",\n          Authorization: \"Bearer \" + localStorage.getItem(\"codemedium-token-admin\")\n        },\n        data: formData\n      }).then(function (response) {\n        alert(\"Post added\");\n\n        _this.props.history.push(\"/admin/posts/home\");\n\n        return response.data;\n      })[\"catch\"](function (error) {\n        return error;\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"handleUpdatePost\", function (e) {\n      console.log(\"content\", _this.state.content);\n      e.preventDefault();\n\n      var slug = _this.state.title.replace(/\\s/g, \"-\");\n\n      if (_this.props.slug) {\n        slug = _this.props.slug;\n      }\n\n      var formData = new FormData();\n      formData.append(\"title\", _this.state.title);\n\n      if (_this.state.image) {\n        formData.append(\"image\", _this.state.image);\n      }\n\n      formData.append(\"content\", _this.state.content);\n      formData.append(\"desc\", _this.state.desc);\n      formData.append(\"creator\", _this.props.user.userId);\n      formData.append(\"slug\", slug);\n      formData.append(\"authorCode\", _this.state.authorCode);\n      formData.append(\"categories\", JSON.stringify(_this.state.selectedCategories.map(function (item) {\n        return item.value;\n      })));\n      console.log(formData);\n      axios({\n        method: \"put\",\n        url: API_URL + \"/admin/feed/post/\" + _this.props.postId,\n        headers: {\n          \"Content-Type\": \"multipart/form-data\",\n          Authorization: \"Bearer \" + localStorage.getItem(\"codemedium-token-admin\")\n        },\n        data: formData\n      }).then(function (response) {\n        alert(\"Post updated\");\n\n        _this.props.history.push(\"/admin/posts/home\");\n\n        return response.data;\n      })[\"catch\"](function (error) {\n        return error;\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onFileChange\", function (value, files) {\n      // if (files) {\n      //   generateBase64FromImage(files[0])\n      //     .then(b64 => {\n      //       this.setState({ imagePreview: b64 });\n      //     })\n      //     .catch(e => {\n      //       this.setState({ imagePreview: null });\n      //     });\n      // }\n      _this.setState({\n        image: files ? files[0] : value\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"updateMainState\", function (stateChunk) {\n      _this.setState(_objectSpread(_objectSpread({}, _this.state), stateChunk));\n    });\n\n    _this.state = {\n      content: _this.props.content,\n      title: _this.props.title,\n      desc: _this.props.desc,\n      authorCode: null,\n      categories: [],\n      selectedCategories: _this.props.selectedCategories || [],\n      isPreview: false\n    };\n    return _this;\n  }\n\n  _createClass(CreatePost, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.getCategories();\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return /*#__PURE__*/_jsxs(\"div\", {\n        style: {\n          padding: \"25px\"\n        },\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: \"action-wrap\",\n          children: /*#__PURE__*/_jsx(Button, {\n            onClick: function onClick() {\n              _this2.setState({\n                isPreview: true\n              });\n            },\n            children: \"Preview\"\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          style: {\n            textAlign: \"center\"\n          },\n          children: /*#__PURE__*/_jsx(\"p\", {\n            children: \"Write Post\"\n          })\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          style: {\n            textAlign: \"center\",\n            marginBottom: 15\n          },\n          children: [/*#__PURE__*/_jsx(\"p\", {\n            children: \"Title\"\n          }), /*#__PURE__*/_jsx(\"input\", {\n            style: {\n              width: \"50%\"\n            },\n            value: this.state.title,\n            onChange: function onChange(e) {\n              _this2.handleChange(e, \"title\");\n            },\n            placeholder: \"title...\"\n          })]\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          style: {\n            textAlign: \"center\",\n            marginBottom: 15\n          },\n          children: [/*#__PURE__*/_jsx(\"p\", {\n            children: \"Add Main Image\"\n          }), /*#__PURE__*/_jsx(\"input\", {\n            className: \"\",\n            type: \"file\",\n            onChange: function onChange(e) {\n              return _this2.onFileChange(e.target.value, e.target.files);\n            }\n          })]\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          style: {\n            textAlign: \"center\",\n            marginBottom: 15\n          },\n          children: [/*#__PURE__*/_jsx(\"p\", {\n            children: \"Description\"\n          }), /*#__PURE__*/_jsx(\"textarea\", {\n            style: {\n              width: \"50%\"\n            },\n            value: this.state.desc,\n            onChange: function onChange(e) {\n              _this2.handleChange(e, \"desc\");\n            }\n          })]\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          style: {\n            textAlign: \"center\",\n            marginBottom: 15\n          },\n          children: [/*#__PURE__*/_jsx(\"p\", {\n            children: \"Select category\"\n          }), /*#__PURE__*/_jsx(\"div\", {\n            style: {\n              zIndex: 10000,\n              position: \"relative\"\n            },\n            children: /*#__PURE__*/_jsx(Select, {\n              isMulti: true,\n              value: this.state.selectedCategories,\n              onChange: function onChange(selected) {\n                _this2.setState({\n                  selectedCategories: selected\n                });\n              },\n              options: this.state.categories\n            })\n          })]\n        }), /*#__PURE__*/_jsx(\"div\", {\n          style: {\n            height: 700\n          },\n          children: /*#__PURE__*/_jsx(Editor, {\n            value: this.state.content,\n            init: {\n              height: 700,\n              menubar: true,\n              // plugins: [\n              //   'advlist',\n              //   'searchreplace visualblocks code fullscreen',\n              //   'insertdatetime media table paste code help wordcount'\n              // ],\n              plugins: [\"print preview paste importcss searchreplace autolink autosave save directionality code visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists wordcount imagetools textpattern noneditable help charmap quickbars emoticons\"],\n              toolbar: \"undo redo | formatselect | bold italic backcolor | \\\n            alignleft aligncenter alignright alignjustify | \\\n            bullist numlist outdent indent | removeformat | help\",\n              body_class: \"my_class\"\n            },\n            onEditorChange: this.handleEditorChange\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: \"bttn-wrap\",\n          children: /*#__PURE__*/_jsxs(\"form\", {\n            className: \"author-id-form\",\n            onSubmit: this.addPost,\n            children: [/*#__PURE__*/_jsxs(\"div\", {\n              \"class\": \"grp\",\n              children: [/*#__PURE__*/_jsx(\"label\", {\n                children: \"Auth code\"\n              }), /*#__PURE__*/_jsx(\"input\", {\n                type: \"text\",\n                value: this.state.authorCode,\n                onChange: function onChange(e) {\n                  _this2.setState({\n                    authorCode: e.target.value\n                  });\n                }\n              })]\n            }), !this.props.editPost && /*#__PURE__*/_jsx(Button, {\n              type: \"submit\",\n              children: \"Publish\"\n            }), this.props.editPost && /*#__PURE__*/_jsxs(Button, {\n              onClick: this.handleUpdatePost,\n              type: \"button\",\n              children: [\" \", \"Update\", \" \"]\n            })]\n          })\n        }), /*#__PURE__*/_jsxs(Modal, {\n          dialogClassName: \"preview-modal\",\n          isOpen: this.state.isPreview,\n          toggle: function toggle() {\n            _this2.setState({\n              isPreview: !_this2.state.isPreview\n            });\n          },\n          children: [/*#__PURE__*/_jsx(ModalHeader, {\n            toggle: function toggle() {\n              _this2.setState({\n                isPreview: !_this2.state.isPreview\n              });\n            },\n            children: \"Preview\"\n          }), /*#__PURE__*/_jsx(ModalBody, {\n            children: /*#__PURE__*/_jsx(Preview, {\n              updateMainState: this.updateMainState,\n              content: this.state.content\n            })\n          }), /*#__PURE__*/_jsx(ModalFooter, {\n            children: /*#__PURE__*/_jsx(Button, {\n              color: \"secondary\",\n              onClick: function onClick() {\n                _this2.setState({\n                  isPreview: false\n                });\n              },\n              children: \"Cancel\"\n            })\n          })]\n        })]\n      });\n    }\n  }]);\n\n  return CreatePost;\n}(React.Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    user: state.profileReducer.user\n  };\n};\n\nexport default connect(mapStateToProps)(CreatePost);","map":null,"metadata":{},"sourceType":"module"}