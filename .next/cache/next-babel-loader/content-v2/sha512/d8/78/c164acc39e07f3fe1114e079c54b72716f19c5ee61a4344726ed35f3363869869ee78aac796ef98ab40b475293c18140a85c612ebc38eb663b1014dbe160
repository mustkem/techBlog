{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/home/mustkeem/Documents/My Projects/all-projects/codemedium/codemedium-frontend/Components/admin/CreatePost/CreatePost.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React from \"react\";\nimport { Editor } from \"@tinymce/tinymce-react\";\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from \"reactstrap\";\nimport { connect } from \"react-redux\";\nimport axios from \"axios\";\nimport { API_URL } from \"../../../config\";\nimport Select from \"react-select\";\nimport Preview from \"./Preview\";\n\nclass CreatePost extends React.Component {\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"getCategories\", () => {\n      axios({\n        method: \"get\",\n        url: API_URL + \"/admin/common/categories\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: \"Bearer \" + localStorage.getItem(\"codemedium-token-admin\")\n        }\n      }).then(response => {\n        this.setState({\n          categories: response.data.categories.map(item => _objectSpread(_objectSpread({}, item), {}, {\n            value: item._id\n          }))\n        });\n        return response.data;\n      }).catch(function (error) {\n        return error;\n      });\n    });\n\n    _defineProperty(this, \"handleChange\", (e, key) => {\n      this.setState({\n        [key]: e.target.value\n      });\n    });\n\n    _defineProperty(this, \"handleEditorChange\", (content, editor) => {\n      console.log(\"Content was updated:\", content);\n      this.setState({\n        content\n      });\n    });\n\n    _defineProperty(this, \"addPost\", e => {\n      console.log(\"content\", this.state.content);\n      e.preventDefault();\n      let slug = this.state.title.replace(/\\s/g, \"-\");\n\n      if (this.props.slug) {\n        slug = this.props.slug;\n      }\n\n      const formData = new FormData();\n      formData.append(\"title\", this.state.title);\n      formData.append(\"image\", this.state.image);\n      formData.append(\"content\", this.state.content);\n      formData.append(\"desc\", this.state.desc);\n      formData.append(\"creator\", this.props.user.userId);\n      formData.append(\"slug\", slug);\n      formData.append(\"authorCode\", this.state.authorCode);\n      formData.append(\"categories\", JSON.stringify(this.state.selectedCategories.map(item => item.value)));\n      console.log(formData);\n      axios({\n        method: \"post\",\n        url: API_URL + \"/admin/feed/post\",\n        headers: {\n          \"Content-Type\": \"multipart/form-data\",\n          Authorization: \"Bearer \" + localStorage.getItem(\"codemedium-token-admin\")\n        },\n        data: formData\n      }).then(response => {\n        alert(\"Post added\");\n        this.props.history.push(\"/admin/posts/home\");\n        return response.data;\n      }).catch(function (error) {\n        return error;\n      });\n    });\n\n    _defineProperty(this, \"handleUpdatePost\", e => {\n      console.log(\"content\", this.state.content);\n      e.preventDefault();\n      let slug = this.state.title.replace(/\\s/g, \"-\");\n\n      if (this.props.slug) {\n        slug = this.props.slug;\n      }\n\n      const formData = new FormData();\n      formData.append(\"title\", this.state.title);\n\n      if (this.state.image) {\n        formData.append(\"image\", this.state.image);\n      }\n\n      formData.append(\"content\", this.state.content);\n      formData.append(\"desc\", this.state.desc);\n      formData.append(\"creator\", this.props.user.userId);\n      formData.append(\"slug\", slug);\n      formData.append(\"authorCode\", this.state.authorCode);\n      formData.append(\"categories\", JSON.stringify(this.state.selectedCategories.map(item => item.value)));\n      console.log(formData);\n      axios({\n        method: \"put\",\n        url: API_URL + \"/admin/feed/post/\" + this.props.postId,\n        headers: {\n          \"Content-Type\": \"multipart/form-data\",\n          Authorization: \"Bearer \" + localStorage.getItem(\"codemedium-token-admin\")\n        },\n        data: formData\n      }).then(response => {\n        alert(\"Post updated\");\n        this.props.history.push(\"/admin/posts/home\");\n        return response.data;\n      }).catch(function (error) {\n        return error;\n      });\n    });\n\n    _defineProperty(this, \"onFileChange\", (value, files) => {\n      // if (files) {\n      //   generateBase64FromImage(files[0])\n      //     .then(b64 => {\n      //       this.setState({ imagePreview: b64 });\n      //     })\n      //     .catch(e => {\n      //       this.setState({ imagePreview: null });\n      //     });\n      // }\n      this.setState({\n        image: files ? files[0] : value\n      });\n    });\n\n    _defineProperty(this, \"updateMainState\", stateChunk => {\n      this.setState(_objectSpread(_objectSpread({}, this.state), stateChunk));\n    });\n\n    this.state = {\n      content: this.props.content,\n      title: this.props.title,\n      desc: this.props.desc,\n      authorCode: null,\n      categories: [],\n      selectedCategories: this.props.selectedCategories || [],\n      isPreview: false\n    };\n  }\n\n  componentDidMount() {\n    this.getCategories();\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      style: {\n        padding: \"25px\"\n      },\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"action-wrap\",\n        children: /*#__PURE__*/_jsxDEV(Button, {\n          onClick: () => {\n            this.setState({\n              isPreview: true\n            });\n          },\n          children: \"Preview\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          textAlign: \"center\"\n        },\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Write Post\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 194,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          textAlign: \"center\",\n          marginBottom: 15\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Title\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          style: {\n            width: \"50%\"\n          },\n          value: this.state.title,\n          onChange: e => {\n            this.handleChange(e, \"title\");\n          },\n          placeholder: \"title...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 198,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          textAlign: \"center\",\n          marginBottom: 15\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Add Main Image\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          className: \"\",\n          type: \"file\",\n          onChange: e => this.onFileChange(e.target.value, e.target.files)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 209,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 207,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          textAlign: \"center\",\n          marginBottom: 15\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Description\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 216,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"textarea\", {\n          style: {\n            width: \"50%\"\n          },\n          value: this.state.desc,\n          onChange: e => {\n            this.handleChange(e, \"desc\");\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          textAlign: \"center\",\n          marginBottom: 15\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"Select category\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            zIndex: 10000,\n            position: \"relative\"\n          },\n          children: /*#__PURE__*/_jsxDEV(Select, {\n            isMulti: true,\n            value: this.state.selectedCategories,\n            onChange: selected => {\n              this.setState({\n                selectedCategories: selected\n              });\n            },\n            options: this.state.categories\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 228,\n            columnNumber: 11\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 227,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          height: 700\n        },\n        children: /*#__PURE__*/_jsxDEV(Editor, {\n          value: this.state.content,\n          init: {\n            height: 700,\n            menubar: true,\n            // plugins: [\n            //   'advlist',\n            //   'searchreplace visualblocks code fullscreen',\n            //   'insertdatetime media table paste code help wordcount'\n            // ],\n            plugins: [\"print preview paste importcss searchreplace autolink autosave save directionality code visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists wordcount imagetools textpattern noneditable help charmap quickbars emoticons\"],\n            toolbar: \"undo redo | formatselect | bold italic backcolor | \\\n            alignleft aligncenter alignright alignjustify | \\\n            bullist numlist outdent indent | removeformat | help\",\n            body_class: \"my_class\"\n          },\n          onEditorChange: this.handleEditorChange\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 244,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 243,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"bttn-wrap\",\n        children: /*#__PURE__*/_jsxDEV(\"form\", {\n          className: \"author-id-form\",\n          onSubmit: this.addPost,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            class: \"grp\",\n            children: [/*#__PURE__*/_jsxDEV(\"label\", {\n              children: \"Auth code\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 270,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"text\",\n              value: this.state.authorCode,\n              onChange: e => {\n                this.setState({\n                  authorCode: e.target.value\n                });\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 271,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 269,\n            columnNumber: 13\n          }, this), !this.props.editPost && /*#__PURE__*/_jsxDEV(Button, {\n            type: \"submit\",\n            children: \"Publish\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 279,\n            columnNumber: 38\n          }, this), this.props.editPost && /*#__PURE__*/_jsxDEV(Button, {\n            onClick: this.handleUpdatePost,\n            type: \"button\",\n            children: [\" \", \"Update\", \" \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 281,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 268,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 267,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Modal, {\n        dialogClassName: \"preview-modal\",\n        isOpen: this.state.isPreview,\n        toggle: () => {\n          this.setState({\n            isPreview: !this.state.isPreview\n          });\n        },\n        children: [/*#__PURE__*/_jsxDEV(ModalHeader, {\n          toggle: () => {\n            this.setState({\n              isPreview: !this.state.isPreview\n            });\n          },\n          children: \"Preview\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 296,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ModalBody, {\n          children: /*#__PURE__*/_jsxDEV(Preview, {\n            updateMainState: this.updateMainState,\n            content: this.state.content\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 304,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 303,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(ModalFooter, {\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            color: \"secondary\",\n            onClick: () => {\n              this.setState({\n                isPreview: false\n              });\n            },\n            children: \"Cancel\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 310,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 309,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 289,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 7\n    }, this);\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    user: state.profileReducer.user\n  };\n};\n\nexport default connect(mapStateToProps)(CreatePost);","map":{"version":3,"sources":["/home/mustkeem/Documents/My Projects/all-projects/codemedium/codemedium-frontend/Components/admin/CreatePost/CreatePost.js"],"names":["React","Editor","Button","Modal","ModalHeader","ModalBody","ModalFooter","connect","axios","API_URL","Select","Preview","CreatePost","Component","constructor","props","method","url","headers","Authorization","localStorage","getItem","then","response","setState","categories","data","map","item","value","_id","catch","error","e","key","target","content","editor","console","log","state","preventDefault","slug","title","replace","formData","FormData","append","image","desc","user","userId","authorCode","JSON","stringify","selectedCategories","alert","history","push","postId","files","stateChunk","isPreview","componentDidMount","getCategories","render","padding","textAlign","marginBottom","width","handleChange","onFileChange","zIndex","position","selected","height","menubar","plugins","toolbar","body_class","handleEditorChange","addPost","editPost","handleUpdatePost","updateMainState","mapStateToProps","profileReducer"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { Editor } from \"@tinymce/tinymce-react\";\nimport { Button, Modal, ModalHeader, ModalBody, ModalFooter } from \"reactstrap\";\nimport { connect } from \"react-redux\";\n\nimport axios from \"axios\";\nimport { API_URL } from \"../../../config\";\n\nimport Select from \"react-select\";\n\nimport Preview from \"./Preview\";\n\nclass CreatePost extends React.Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      content: this.props.content,\n      title: this.props.title,\n      desc: this.props.desc,\n      authorCode: null,\n      categories: [],\n      selectedCategories: this.props.selectedCategories || [],\n      isPreview: false,\n    };\n  }\n\n  componentDidMount() {\n    this.getCategories();\n  }\n\n  getCategories = () => {\n    axios({\n      method: \"get\",\n      url: API_URL + \"/admin/common/categories\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization:\n          \"Bearer \" + localStorage.getItem(\"codemedium-token-admin\"),\n      },\n    })\n      .then((response) => {\n        this.setState({\n          categories: response.data.categories.map((item) => ({\n            ...item,\n            value: item._id,\n          })),\n        });\n        return response.data;\n      })\n      .catch(function (error) {\n        return error;\n      });\n  };\n\n  handleChange = (e, key) => {\n    this.setState({\n      [key]: e.target.value,\n    });\n  };\n\n  handleEditorChange = (content, editor) => {\n    console.log(\"Content was updated:\", content);\n\n    this.setState({\n      content,\n    });\n  };\n\n  addPost = (e) => {\n    console.log(\"content\", this.state.content);\n\n    e.preventDefault();\n    let slug = this.state.title.replace(/\\s/g, \"-\");\n    if (this.props.slug) {\n      slug = this.props.slug;\n    }\n\n    const formData = new FormData();\n    formData.append(\"title\", this.state.title);\n    formData.append(\"image\", this.state.image);\n    formData.append(\"content\", this.state.content);\n    formData.append(\"desc\", this.state.desc);\n    formData.append(\"creator\", this.props.user.userId);\n    formData.append(\"slug\", slug);\n    formData.append(\"authorCode\", this.state.authorCode);\n    formData.append(\n      \"categories\",\n      JSON.stringify(this.state.selectedCategories.map((item) => item.value))\n    );\n\n    console.log(formData);\n\n    axios({\n      method: \"post\",\n      url: API_URL + \"/admin/feed/post\",\n      headers: {\n        \"Content-Type\": \"multipart/form-data\",\n        Authorization:\n          \"Bearer \" + localStorage.getItem(\"codemedium-token-admin\"),\n      },\n      data: formData,\n    })\n      .then((response) => {\n        alert(\"Post added\");\n        this.props.history.push(\"/admin/posts/home\");\n        return response.data;\n      })\n      .catch(function (error) {\n        return error;\n      });\n  };\n\n  handleUpdatePost = (e) => {\n    console.log(\"content\", this.state.content);\n\n    e.preventDefault();\n    let slug = this.state.title.replace(/\\s/g, \"-\");\n    if (this.props.slug) {\n      slug = this.props.slug;\n    }\n\n    const formData = new FormData();\n    formData.append(\"title\", this.state.title);\n    if (this.state.image) {\n      formData.append(\"image\", this.state.image);\n    }\n    formData.append(\"content\", this.state.content);\n    formData.append(\"desc\", this.state.desc);\n    formData.append(\"creator\", this.props.user.userId);\n    formData.append(\"slug\", slug);\n    formData.append(\"authorCode\", this.state.authorCode);\n    formData.append(\n      \"categories\",\n      JSON.stringify(this.state.selectedCategories.map((item) => item.value))\n    );\n\n    console.log(formData);\n\n    axios({\n      method: \"put\",\n      url: API_URL + \"/admin/feed/post/\" + this.props.postId,\n      headers: {\n        \"Content-Type\": \"multipart/form-data\",\n        Authorization:\n          \"Bearer \" + localStorage.getItem(\"codemedium-token-admin\"),\n      },\n      data: formData,\n    })\n      .then((response) => {\n        alert(\"Post updated\");\n        this.props.history.push(\"/admin/posts/home\");\n        return response.data;\n      })\n      .catch(function (error) {\n        return error;\n      });\n  };\n\n  onFileChange = (value, files) => {\n    // if (files) {\n    //   generateBase64FromImage(files[0])\n    //     .then(b64 => {\n    //       this.setState({ imagePreview: b64 });\n    //     })\n    //     .catch(e => {\n    //       this.setState({ imagePreview: null });\n    //     });\n    // }\n    this.setState({\n      image: files ? files[0] : value,\n    });\n  };\n\n  updateMainState = (stateChunk) => {\n    this.setState({\n      ...this.state,\n      ...stateChunk,\n    });\n  };\n\n  render() {\n    return (\n      <div style={{ padding: \"25px\" }}>\n        <div className=\"action-wrap\">\n          <Button\n            onClick={() => {\n              this.setState({ isPreview: true });\n            }}\n          >\n            Preview\n          </Button>\n        </div>\n        <div style={{ textAlign: \"center\" }}>\n          <p>Write Post</p>\n        </div>\n        <div style={{ textAlign: \"center\", marginBottom: 15 }}>\n          <p>Title</p>\n          <input\n            style={{ width: \"50%\" }}\n            value={this.state.title}\n            onChange={(e) => {\n              this.handleChange(e, \"title\");\n            }}\n            placeholder=\"title...\"\n          ></input>\n        </div>\n        <div style={{ textAlign: \"center\", marginBottom: 15 }}>\n          <p>Add Main Image</p>\n          <input\n            className=\"\"\n            type=\"file\"\n            onChange={(e) => this.onFileChange(e.target.value, e.target.files)}\n          />\n        </div>\n        <div style={{ textAlign: \"center\", marginBottom: 15 }}>\n          <p>Description</p>\n          <textarea\n            style={{ width: \"50%\" }}\n            value={this.state.desc}\n            onChange={(e) => {\n              this.handleChange(e, \"desc\");\n            }}\n          />\n        </div>\n        <div style={{ textAlign: \"center\", marginBottom: 15 }}>\n          <p>Select category</p>\n          <div style={{zIndex:10000, position:\"relative\"}}>\n          <Select\n            \n            isMulti\n            value={this.state.selectedCategories}\n            onChange={(selected) => {\n              this.setState({\n                selectedCategories: selected,\n              });\n            }}\n            options={this.state.categories}\n          />\n          </div>\n          \n        </div>\n\n        <div style={{ height: 700 }}>\n          <Editor\n            value={this.state.content}\n            init={{\n              height: 700,\n              menubar: true,\n              // plugins: [\n              //   'advlist',\n              //   'searchreplace visualblocks code fullscreen',\n              //   'insertdatetime media table paste code help wordcount'\n              // ],\n              plugins: [\n                \"print preview paste importcss searchreplace autolink autosave save directionality code visualblocks visualchars fullscreen image link media template codesample table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists wordcount imagetools textpattern noneditable help charmap quickbars emoticons\",\n              ],\n              toolbar:\n                \"undo redo | formatselect | bold italic backcolor | \\\n            alignleft aligncenter alignright alignjustify | \\\n            bullist numlist outdent indent | removeformat | help\",\n\n              body_class: \"my_class\",\n            }}\n            onEditorChange={this.handleEditorChange}\n          />\n        </div>\n        <div className=\"bttn-wrap\">\n          <form className=\"author-id-form\" onSubmit={this.addPost}>\n            <div class=\"grp\">\n              <label>Auth code</label>\n              <input\n                type=\"text\"\n                value={this.state.authorCode}\n                onChange={(e) => {\n                  this.setState({ authorCode: e.target.value });\n                }}\n              />\n            </div>\n            {!this.props.editPost && <Button type=\"submit\">Publish</Button>}\n            {this.props.editPost && (\n              <Button onClick={this.handleUpdatePost} type=\"button\">\n                {\" \"}\n                Update{\" \"}\n              </Button>\n            )}\n          </form>\n        </div>\n\n        <Modal\n          dialogClassName=\"preview-modal\"\n          isOpen={this.state.isPreview}\n          toggle={() => {\n            this.setState({ isPreview: !this.state.isPreview });\n          }}\n        >\n          <ModalHeader\n            toggle={() => {\n              this.setState({ isPreview: !this.state.isPreview });\n            }}\n          >\n            Preview\n          </ModalHeader>\n          <ModalBody>\n            <Preview\n              updateMainState={this.updateMainState}\n              content={this.state.content}\n            />\n          </ModalBody>\n          <ModalFooter>\n            <Button\n              color=\"secondary\"\n              onClick={() => {\n                this.setState({\n                  isPreview: false,\n                });\n              }}\n            >\n              Cancel\n            </Button>\n          </ModalFooter>\n        </Modal>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    user: state.profileReducer.user,\n  };\n};\n\nexport default connect(mapStateToProps)(CreatePost);\n"]},"metadata":{},"sourceType":"module"}